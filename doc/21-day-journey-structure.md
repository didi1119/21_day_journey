# 靜謐森林 21 天旅程 - 模組化架構

## 📋 專案概覽

這是一個高度模組化、可擴展的 21 天心靈旅程框架，採用現代化的前端架構設計，支援未來的功能擴展需求。

## 🏗️ 架構設計

### 核心特色
- **模組化設計**：每個功能獨立成模組，便於維護和擴展
- **配置驅動**：透過配置檔案控制所有功能開關
- **內容分離**：HTML 內容與邏輯完全分離
- **未來準備**：為登入、線上儲存、個人化等功能預留接口

### 檔案結構
```
21-day-journey/
├── index.html              # 主旅程頁面
├── config/                 # 配置系統
│   ├── config.js           # 全域配置
│   ├── animals.js          # 動物類型設定
│   └── content-types.js    # 內容類型定義
├── days/                   # 日頁面內容 (day1.html ~ day21.html)
├── core/                   # 核心模組
│   ├── content-loader.js   # 內容載入器
│   ├── progress-manager.js # 進度管理器
│   ├── storage-manager.js  # 儲存管理器
│   └── auth-manager.js     # 權限管理器
├── templates/              # 模板系統
│   └── day-template.html   # 日頁面標準模板
└── assets/                 # 靜態資源
    ├── css/, js/, images/, audio/
```

## 🔧 核心模組說明

### 1. ContentLoader (內容載入器)
- 動態載入 day1-day21.html 內容
- 支援快取機制和重試邏輯
- 處理載入錯誤和內容驗證

### 2. ProgressManager (進度管理器)
- 管理用戶旅程進度
- 支援每日解鎖制度
- 追蹤完成狀態和統計數據

### 3. StorageManager (儲存管理器)
- 統一管理本機和線上儲存
- 支援日誌、設定、創作內容儲存
- 提供匯入匯出功能

### 4. AuthManager (權限管理器)
- 為未來登入功能預留接口
- 管理用戶權限和認證狀態
- 支援 token 管理和自動刷新

## 🎛️ 配置系統

### CONFIG (config.js)
全域配置控制所有功能開關：
```javascript
features: {
  requireLogin: false,        // 是否需要登入
  dailyUnlock: false,         // 是否每日解鎖制
  onlineStorage: false,       // 是否使用線上儲存
  animalPersonalization: false, // 動物個人化
}
```

### ANIMALS (animals.js)
動物類型配置，支援個人化內容變體。

### CONTENT_TYPES (content-types.js)
標準化所有內容類型的結構與樣式。

## 📄 Day 內容結構

每個 day.html 檔案包含標準化的內容區塊：

1. **主理人筆記** (必要) - 每日的引導與分享
2. **聽覺引導** (可選) - 音頻冥想指導
3. **微小行動** (可選) - 簡單的日常練習
4. **內在探索** (可選) - 日誌反思問題
5. **森林的智慧** (可選) - 知識分享
6. **森林的禮物** (可選) - 特殊祝福
7. **今日的森林一隅** (可選) - 視覺內容
8. **創造與表達** (可選) - 創意活動
9. **今日結語** (必要) - 溫暖的結束

## 🚀 使用方式

### 基本啟動
1. 開啟 `index.html`
2. 系統自動載入配置和模組
3. 點擊旅程地圖上的日期來瀏覽內容

### 開發模式
- 修改 `config/config.js` 來調整功能開關
- 編輯 `days/dayX.html` 來更新日內容
- 使用 `templates/day-template.html` 作為新內容的範本

## 🔮 未來擴展

### 已準備的功能擴展點

1. **用戶登入系統**
   - AuthManager 已預留完整接口
   - 支援 token 認證和權限管理

2. **每日解鎖制度**
   - ProgressManager 支援解鎖邏輯
   - 可設定開始日期和解鎖條件

3. **線上儲存**
   - StorageManager 支援 API 整合
   - 自動同步本機和雲端數據

4. **動物個人化**
   - 基於森林人格測驗結果
   - 提供個人化的內容變體

5. **進階功能**
   - 社群分享
   - 進度統計
   - 推薦系統

### 添加新功能步驟

1. **更新配置**：在 `config.js` 中添加功能開關
2. **擴展模組**：在現有模組中添加新方法
3. **更新界面**：修改 `index.html` 中的主應用程式
4. **測試整合**：確保新功能與現有系統相容

## 🛠️ 技術規格

- **前端框架**：純 JavaScript (ES6+)
- **樣式系統**：Tailwind CSS
- **模組系統**：支援 CommonJS 和瀏覽器環境
- **儲存方案**：localStorage + 未來 API 整合
- **相容性**：現代瀏覽器 (支援 ES6+ 和 Fetch API)

## 📝 開發注意事項

1. **路徑管理**：使用相對路徑，避免硬編碼
2. **錯誤處理**：所有非同步操作都有完整的錯誤處理
3. **效能優化**：內容載入採用快取機制
4. **擴展性**：所有模組都支援配置注入
5. **維護性**：清晰的模組分離和文件結構

---

這個架構設計確保了系統的可維護性、可擴展性，並為未來的功能需求提供了堅實的基礎。
